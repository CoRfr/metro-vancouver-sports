<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metro Vancouver Sports Schedules</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Metro Vancouver Drop-In</h1>
        </header>

        <details class="info-box">
            <summary>Disclaimer & About</summary>
            <div class="info-box-content">
                <div class="disclaimer">
                    <strong>Heads up!</strong>
                    This site aggregates data from multiple sources. Schedules can change without notice.
                    Always double-check with the official source before heading out!
                </div>
                <p id="scheduleStatus">Loading schedule data...</p>
                <p class="feedback-link">
                    Found a bug or have a feature request? <a href="https://github.com/CoRfr/metro-vancouver-sports/issues" target="_blank">Report it on GitHub</a>
                </p>
                <div class="data-sources">
                    <h4>Data Sources</h4>
                    <div class="data-source-item" data-city="Vancouver">
                        <span class="data-source-city">Vancouver</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://anc.ca.apm.activecommunities.com/vancouver/calendars?onlineSiteId=0&defaultCalendarId=3&displayType=0&view=2" target="_blank">ActiveNet Calendar API</a></span>
                    </div>
                    <div class="data-source-item" data-city="Burnaby">
                        <span class="data-source-city">Burnaby</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.burnaby.ca/recreation-and-arts/activities-and-registration/daily-activities?activity_tid=656" target="_blank">burnaby.ca</a> (weekly schedules)</span>
                    </div>
                    <div class="data-source-item" data-city="Richmond">
                        <span class="data-source-city">Richmond</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.richmond.ca/parks-recreation/about/schedules.htm" target="_blank">richmond.ca</a> (weekly schedules)</span>
                    </div>
                    <div class="data-source-item" data-city="Coquitlam">
                        <span class="data-source-city">Coquitlam</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.coquitlam.ca/979/Drop-In-Activities" target="_blank">coquitlam.ca</a> (weekly schedules)</span>
                    </div>
                    <div class="data-source-item" data-city="Port Coquitlam">
                        <span class="data-source-city">Port Coquitlam</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.portcoquitlam.ca/recreation-parks/skating/public-skates" target="_blank">portcoquitlam.ca</a> (weekly schedules)</span>
                    </div>
                    <div class="data-source-item" data-city="North Vancouver">
                        <span class="data-source-city">North Vancouver</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.nvrc.ca/drop-in-schedules?activity=551" target="_blank">NVRC Drop-in Schedules</a></span>
                    </div>
                    <div class="data-source-item" data-city="West Vancouver">
                        <span class="data-source-city">West Vancouver</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://westvancouver.ca/parks-recreation/recreation-programs-services/daily-activities-search-results" target="_blank">westvancouver.ca</a></span>
                    </div>
                    <div class="data-source-item" data-city="New Westminster">
                        <span class="data-source-city">New Westminster</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://cityofnewwestminster.perfectmind.com/23693/Clients/BookMe4BookingPages/Classes?calendarId=db250b43-ef6b-43c5-979e-3f3d1dab2d67" target="_blank">PerfectMind</a></span>
                    </div>
                    <div class="data-source-item" data-city="Langley">
                        <span class="data-source-city">Langley</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.tol.ca/en/parks-recreation/skating-and-stick-puck-drop-in-schedule.aspx" target="_blank">tol.ca</a> (PerfectMind)</span>
                    </div>
                    <div class="data-source-item" data-city="Outdoor">
                        <span class="data-source-city">Outdoor Rinks</span>
                        <span class="data-source-count"></span>
                        <span class="data-source-info"><a href="https://www.robsonsquare.com/" target="_blank">Robson Square</a>, <a href="https://www.cnv.org/parks-recreation/the-shipyards/skate-plaza" target="_blank">The Shipyards</a></span>
                    </div>
                </div>
            </div>
        </details>

        <div class="controls">
            <div class="filter-group">
                <div class="filter-item">
                    <label>Sport</label>
                    <div class="dropdown-single" id="sportFilter">
                        <div class="dropdown-single-trigger">
                            <span class="sport-icon">‚õ∏Ô∏è</span>
                            <span>Ice Skating</span>
                        </div>
                        <div class="dropdown-single-menu">
                            <div class="dropdown-single-item selected" data-value="skating">
                                <span class="sport-icon">‚õ∏Ô∏è</span>
                                <span>Ice Skating</span>
                            </div>
                            <div class="dropdown-single-item" data-value="swimming">
                                <span class="sport-icon">üèä</span>
                                <span>Swimming</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-item">
                    <label>City</label>
                    <div class="dropdown-multi" id="cityFilter">
                        <div class="dropdown-multi-trigger"><span>All Cities</span></div>
                        <div class="dropdown-multi-menu">
                            <label class="dropdown-multi-item"><input type="checkbox" value="Vancouver"><span>Vancouver</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="Burnaby"><span>Burnaby</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="Richmond"><span>Richmond</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="North Vancouver"><span>North Vancouver</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="West Vancouver"><span>West Vancouver</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="New Westminster"><span>New Westminster</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="Port Coquitlam"><span>Port Coquitlam</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="Coquitlam"><span>Coquitlam</span></label>
                            <label class="dropdown-multi-item"><input type="checkbox" value="Langley"><span>Langley</span></label>
                        </div>
                    </div>
                </div>

                <div class="filter-item">
                    <label>Facility</label>
                    <div class="dropdown-multi" id="facilityFilter">
                        <div class="dropdown-multi-trigger"><span>All Facilities</span></div>
                        <div class="dropdown-multi-menu">
                            <!-- Populated dynamically -->
                        </div>
                    </div>
                </div>

                <div class="filter-item">
                    <label for="postalCode">Location</label>
                    <div class="location-row">
                        <input type="text" id="postalCode" placeholder="Postal code">
                        <button id="useLocationBtn">üìç Locate</button>
                    </div>
                </div>

                <div class="filter-item">
                    <label for="distanceFilter">Distance</label>
                    <select id="distanceFilter">
                        <option value="999">Any Distance</option>
                        <option value="2">2 km</option>
                        <option value="5">5 km</option>
                        <option value="10" selected>10 km</option>
                        <option value="15">15 km</option>
                    </select>
                </div>

            </div>

            <div class="activity-filters" id="activityFilters">
                <strong>Activity Types:</strong>
                <label class="activity-checkbox">
                    <input type="checkbox" id="activityPublic" value="Public Skating" checked>
                    <span>Public Skating</span>
                </label>
                <label class="activity-checkbox">
                    <input type="checkbox" id="activityFamily" value="Family Skate" checked>
                    <span>Family Skating</span>
                </label>
                <label class="activity-checkbox">
                    <input type="checkbox" id="activityHockey" value="Family Hockey">
                    <span>Family Hockey</span>
                </label>
                <label class="activity-checkbox">
                    <input type="checkbox" id="activityFigure" value="Figure Skating" checked>
                    <span>Figure Skating</span>
                </label>
            </div>
        </div>

        <div class="map-panel" id="mapPanel">
            <div class="map-panel-header" id="mapPanelHeader">
                <h3><span>üìç</span> <span id="mapTitle">Facility Map</span></h3>
                <span class="map-panel-toggle">‚ñº</span>
            </div>
            <div class="map-panel-content">
                <div id="facilityMap"></div>
                <div class="map-legend">
                    <div class="legend-item"><div class="legend-dot vancouver"></div> Vancouver</div>
                    <div class="legend-item"><div class="legend-dot burnaby"></div> Burnaby</div>
                    <div class="legend-item"><div class="legend-dot richmond"></div> Richmond</div>
                    <div class="legend-item"><div class="legend-dot poco"></div> Port Coquitlam</div>
                    <div class="legend-item"><div class="legend-dot coquitlam"></div> Coquitlam</div>
                    <div class="legend-item"><div class="legend-dot northvan"></div> North Vancouver</div>
                    <div class="legend-item"><div class="legend-dot westvan"></div> West Vancouver</div>
                    <div class="legend-item"><div class="legend-dot newwest"></div> New Westminster</div>
                    <div class="legend-item"><div class="legend-dot langley"></div> Langley</div>
                    <div class="legend-item skating-only"><div class="legend-dot outdoor"></div> Outdoor Rinks</div>
                </div>
            </div>
        </div>

        <div class="calendar-container">
            <div class="calendar-header">
                <h2 id="currentMonth"></h2>
                <div class="calendar-controls">
                    <div class="view-toggle">
                        <button id="dayViewBtn" class="active">Day</button>
                        <button id="weekViewBtn">Week</button>
                        <button id="monthViewBtn">Month</button>
                    </div>
                    <div class="calendar-nav">
                        <button id="prevBtn">‚Üê Previous</button>
                        <button id="nextBtn">Next ‚Üí</button>
                    </div>
                </div>
            </div>
            <div class="calendar-grid day-view" id="calendar"></div>
        </div>
    </div>

    <div class="modal" id="sessionModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"></div>
                <button class="modal-close" id="modalClose">√ó</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>

    <button class="dark-mode-toggle" id="darkModeToggle" title="Toggle dark mode">
        <span class="icon-moon">üåô</span>
        <span class="icon-sun">‚òÄÔ∏è</span>
    </button>

    <script src="js/app.js"></script>
</body>
</html>
